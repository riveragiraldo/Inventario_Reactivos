{% extends "webtemplate.html" %}
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Estado de solicitud {{inventario.name}}{% endblock %}</title>
  {% block head %}
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
    crossorigin="anonymous" defer></script> -->
    <!-- Incluir SweetAlert2 desde CDN -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.css">
  <style>
    .card {
      width: 500px;
      margin: 0 auto;
      margin-top: 50px;
    }

    .card-header {
      font-weight: bold;
      font-size: 26px;
      margin-bottom: 5px;

    }

    .card-body ul li {
      /* margin-top: 1px; */
      padding: 5px 0;
    }

    .close-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
    }
  </style>
  {% endblock %}
</head>

<body>
  {% block content %}
  <div class="card">
    <div class="card-header">
      Estado de solicitud número {{solicitud.id|stringformat:"04d"}}
    </div>
    <div class="card-body">
      <h5>Información principal:</h5>
      <ul class="list-unstyled">
        <li><strong>Fecha de radicación de la solicitud: </strong> {{solicitud.date_create}}</li>
        <li><strong>Tipo de solicitud: </strong> {{solicitud.tipo_solicitud}}</li>

        {% if solicitud.name %}
        <li><strong>Otro tipo solicitud: </strong> {{solicitud.name}}</li>
        {% endif %}

        <li><strong>Mensaje: </strong>
          <p>{{solicitud.mensaje}}</p>
        </li>

        {% if solicitud.archivos_adjuntos %}
        <li><strong>Archivos Adjuntos: </strong> <a href="{{ solicitud.archivos_adjuntos.url }}">Clic para descargar</a>
        </li>
        {% endif %}



      </ul>
      <h5>Estado de la solicitud:</h5>
      <ul class="list-unstyled">
        <li><strong>Estado del trámite: </strong>
          {% if solicitud.tramitado %}
          Tramitado
          {% else %}
          Pendiente, pronto recibirás noticias sobre tu solicitud .
          {% endif %}
        </li>

        {% if solicitud.tramitado %}
        <li><strong>Observaciones del trámite: </strong>
          <p>{{solicitud.observaciones }}</p>
        </li>
        <li><strong>Usuario que tramita: </strong>{{solicitud.usuario_tramita.first_name}}
          {{solicitud.usuario_tramita.last_name}}</li>
        <li><strong>Fecha de trámite: </strong> {{solicitud.fecha_tramite|date:"d/m/Y"}}</li>

        {% endif %}


      </ul>
    </div>
    
    <div class="card-footer">
      <button class="btn btn-primary" onclick="closeTab()">Aceptar</button>

    </div>
  </div>
<script>
  function closeTab() {
    let countdown = 3;

    // Abre una SweetAlert con un div personalizado para mostrar el contador.
    Swal.fire({
        title: 'La ventana se cerrará en...',
        html: '<div id="countdown">' + countdown + '</div>',
        showConfirmButton: false,
    });

    // Actualiza el contador en el div personalizado cada segundo.
    const countdownInterval = setInterval(function () {
        countdown--;
        const countdownElement = document.getElementById('countdown');
        if (countdownElement) {
            countdownElement.innerText = countdown;
        }

        if (countdown <= 0) {
            clearInterval(countdownInterval);
            Swal.close(); // Cierra la SweetAlert.
            if (window.close) {
                window.close();
            } else {
                window.location.href = '/';
            }
        }
    }, 1000); // 1000 ms = 1 segundo
}



</script>

  {% endblock %}
</body>

</html>